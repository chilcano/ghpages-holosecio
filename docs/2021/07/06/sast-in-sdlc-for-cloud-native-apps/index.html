<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> SAST in your SDLC for Cloud-Native Apps | Holistic Security</title>
  <meta name="description" content="With The Systems Thinking Methodology we are able to see any problem in a complete and holistic manner, in fact, The Systems Thinking Methodology allows us to solve complex problems (IT Security, Global Warming, World Poverty, etc.) by considering new factors, elements and variables (usability, trust, quality, risk, etc.) which were not considered initially.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="SAST in your SDLC for Cloud-Native Apps" />
<meta property="og:description" content="SAST stands for &ldquo;Static Application Security Testing&rdquo; and it is used to identify vulnerabilities
by reviewing the source code. The best point or place to implement this Security Testing, and according the Security Best Practices, is in early stages of your
CI/CD Pipeline. But What about of SAST in Cloud Native Applications?. You will see in this post  how to deal with that using only opensource.



Static Application Security Testing (SAST) in the Cloud Native SDLC

" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://holisticsecurity.io/2021/07/06/sast-in-sdlc-for-cloud-native-apps/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-07-06T10:00:10+02:00" />
<meta property="article:modified_time" content="2021-07-06T10:00:10+02:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SAST in your SDLC for Cloud-Native Apps"/>
<meta name="twitter:description" content="SAST stands for &ldquo;Static Application Security Testing&rdquo; and it is used to identify vulnerabilities
by reviewing the source code. The best point or place to implement this Security Testing, and according the Security Best Practices, is in early stages of your
CI/CD Pipeline. But What about of SAST in Cloud Native Applications?. You will see in this post  how to deal with that using only opensource.



Static Application Security Testing (SAST) in the Cloud Native SDLC

"/>

  
  
    
  
  
  <link rel="stylesheet" href="https://holisticsecurity.io/css/style-white.css">
  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://holisticsecurity.io/images/favicon.ico" />

  
  
  
  
  
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-156433649-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
  
  

  <link rel="stylesheet" href="https://holisticsecurity.io/css/custom-cactus-style-white.css">
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

    <header id="header">
  <a href="https://holisticsecurity.io/">
  
    <div id="logo" style="background-image: url(https://holisticsecurity.io/images/logo.png)"></div>
  
  <div id="title">
    <h1>Holistic Security</h1>
  </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#"><i class="fas fa-bars fa-2x"></i></a>
      </li>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/post">Blog</a></li>
      
        <li><a href="/taxonomy">Taxonomy</a></li>
      
        <li><a href="/about">About</a></li>
      
    </ul>
  </div>
</header>



    
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  
  <h1 class="posttitle" itemprop="name headline"> SAST in your SDLC for Cloud-Native Apps </h1>

  <ul class="post-list">  
      <li class="post-item">
        <div class="meta">
          <time datetime="2021-07-06 10:00:10 &#43;0200 CEST" itemprop="datePublished">2021-07-06</time>
        </div>
        <span>    
          
          
          <div class="article-category">
              
              
              <a class="category-link" href="/categories/cloud">Cloud</a>
              
               路 
              <a class="category-link" href="/categories/sdlc">SDLC</a>
              
               路 
              <a class="category-link" href="/categories/devsecops">DevSecOps</a>
              
               路 
              <a class="category-link" href="/categories/holism">Holism</a>
              
              路 
          </div>
          
          
          <div class="article-tag">
              
              
              <a class="tag-link" href="/tags/sast" rel="tag">SAST</a>
              
          </div>
          
  
        </span>
      </li>  
    </ul>

  <div class="content" itemprop="articleBody">
  
    <p><a href="https://en.wikipedia.org/wiki/Static_application_security_testing">SAST</a> stands for &ldquo;Static Application Security Testing&rdquo; and it is used to identify vulnerabilities
by reviewing the source code. The best point or place to implement this Security Testing, and according the Security Best Practices, is in early stages of your
CI/CD Pipeline. But What about of SAST in Cloud Native Applications?. You will see in this post  how to deal with that using only opensource.</p>
<p><a href="/assets/blog20210706_sast/20210706-sast-in-your-sdlc-for-cloud-native-apps.png"><img src="/assets/blog20210706_sast/20210706-sast-in-your-sdlc-for-cloud-native-apps.png" alt=""></a>


<i><center>Static Application Security Testing (SAST) in the Cloud Native SDLC</center></i>

</p>
<h2 id="sast-in-cloud-native-applications">SAST in Cloud-Native Applications</h2>
<p>Implement SAST in old-school or traditional Application is/was easy because you have to deal with a big block or a monolithic stack, but how to do the same with Cloud
Native Applications?. The answer is using as many SAST tools as different types of code, artifacts or building blocks compose your stack.<br>
For example, a standard Cloud Native Application stack is composed of:</p>
<ol>
<li>Microservices in different languages (Python, Golang, PHP, &hellip;)</li>
<li>REST and GraphQL APIs</li>
<li>Docker containers (Dockerfile)</li>
<li>Infrastructure as Code (Terraform, CloudFormation, Kubernetes manifests, &hellip;)</li>
<li>Configuration code (Chef, Bash, Ansible, &hellip;)</li>
</ol>
<p>Then, we are going to require 5 or less different SAST tools to review statically the code for each kind of code or artifact. Below I show a SAST tool list where you can pickup any tool for convenience or based on your requirements.</p>
<h3 id="opensource-sast-tools-for-cloud-native-stacks">Opensource SAST tools for Cloud-Native stacks</h3>
<p>I&rsquo;m going to list only a few SAST tools, but if you want to browse the full list, even DAST, IAST or RASP tools, look my post about <a href="/2020/02/10/security-along-the-container-based-sdlc/#oss-sec-list">Security along the SDLC for Cloud-Native Apps</a>.</p>
<table>
<thead>
<tr>
<th>No.</th>
<th>SAST Tool</th>
<th></th>
<th>Vulnerability scanner for</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.</td>
<td><a href="https://github.com/anchore/grype">Anchore Grype</a></td>
<td><img src="/assets/blog20210706_sast/sast-anchore-grype.png" alt=""></td>
<td>Containers and filesystems</td>
</tr>
<tr>
<td>2.</td>
<td><a href="https://github.com/aquasecurity/trivy">AquaSec Trivy</a></td>
<td><img src="/assets/blog20210706_sast/sast-aquasec-trivy.png" alt=""></td>
<td>Containers and application dependencies (Bundler, Composer, npm, yarn, etc)</td>
</tr>
<tr>
<td>3.</td>
<td><a href="https://github.com/aws-cloudformation/cfn-lint">AWS Cfn-Lint</a></td>
<td><img src="/assets/blog20210706_sast/sast-cfn-lint.png" alt=""></td>
<td>CloudFormation (.json, .yaml). Rules in Python</td>
</tr>
<tr>
<td>4.</td>
<td><a href="https://github.com/awslabs/serverless-rules">AWS Serverless Rules</a></td>
<td><img src="" alt=""></td>
<td>Serverless Patterns in CloudFormation</td>
</tr>
<tr>
<td>5.</td>
<td><a href="https://github.com/PyCQA/bandit">Bandit</a></td>
<td><img src="/assets/blog20210706_sast/sast-bandit.png" alt=""></td>
<td>Python code</td>
</tr>
<tr>
<td>6.</td>
<td><a href="https://github.com/Checkmarx/kics">Checkmarx KICS</a></td>
<td><img src="/assets/blog20210706_sast/sast-checkmarx-kics.png" alt=""></td>
<td>Terraform (.tf, tfvars), CloudFormation (.json or .yaml), Ansible (.yaml), Dockerfile, K8s manifests, OpenAPI (.json or .yaml)</td>
</tr>
<tr>
<td>7.</td>
<td><a href="https://github.com/bridgecrewio/checkov">Checkov</a></td>
<td><img src="/assets/blog20210706_sast/sast-checkov.png" alt=""></td>
<td>Terraform, CloudFormation, Kubernetes, Dockerfile, ARM Templates.</td>
</tr>
<tr>
<td>8.</td>
<td><a href="https://github.com/quay/clair">Clair</a></td>
<td><img src="/assets/blog20210706_sast/sast-clair.png" alt=""></td>
<td>Containers</td>
</tr>
<tr>
<td>9.</td>
<td><a href="https://github.com/eliasgranderubio/dagda">Dagda</a></td>
<td><img src="" alt=""></td>
<td>Containers and monitor Docker daemon</td>
</tr>
<tr>
<td>10.</td>
<td><a href="https://github.com/goodwithtech/dockle">Dockle</a></td>
<td><img src="/assets/blog20210706_sast/sast-dockle.png" alt=""></td>
<td>Containers and support CIS Benchmarks</td>
</tr>
<tr>
<td>11.</td>
<td><a href="https://github.com/golangci/golangci-lint">GolangCI-Lint</a></td>
<td><img src="/assets/blog20210706_sast/sast-golangci-lint.png" alt=""></td>
<td>Golang code</td>
</tr>
<tr>
<td>12.</td>
<td><a href="https://github.com/securego/gosec">GoSec</a></td>
<td><img src="/assets/blog20210706_sast/sast-gosec.png" alt=""></td>
<td>Golang code</td>
</tr>
<tr>
<td>13.</td>
<td><a href="https://github.com/globocom/huskyCI">huskyCI</a></td>
<td><img src="/assets/blog20210706_sast/sast-huskyci.png" alt=""></td>
<td>Orchestrate security test (Python, JS, Ruby, Tf, Golang, Java, &hellip;) and centralizes all results</td>
</tr>
<tr>
<td>14.</td>
<td><a href="https://github.com/phpstan/phpstan">PHPStan</a></td>
<td><img src="/assets/blog20210706_sast/sast-phpstan.png" alt=""></td>
<td>PHP code</td>
</tr>
<tr>
<td>15.</td>
<td><a href="https://www.pylint.org">Pylint</a></td>
<td><img src="/assets/blog20210706_sast/sast-pylint.png" alt=""></td>
<td>Python code</td>
</tr>
<tr>
<td>16.</td>
<td><a href="https://semgrep.dev/">Semgrep</a></td>
<td><img src="/assets/blog20210706_sast/sast-semgrep.png" alt=""></td>
<td>Works on 17+ languages. Write rules that look like your code.</td>
</tr>
<tr>
<td>17.</td>
<td><a href="https://github.com/Skyscanner/cfrippe">Skyscanner CFrippe</a></td>
<td><img src="/assets/blog20210706_sast/sast-skyscanner-cfrippe.png" alt=""></td>
<td>CloudFormation (.json, .yaml). Rules in Python</td>
</tr>
<tr>
<td>18.</td>
<td><a href="https://www.sonarqube.org">SonarQube CE</a></td>
<td><img src="/assets/blog20210706_sast/sast-sonarqube.png" alt=""></td>
<td>Platform and carry out analysis of over 20 programming languages</td>
</tr>
<tr>
<td>19.</td>
<td><a href="https://github.com/spotbugs/spotbugs">SpotBugs</a></td>
<td><img src="/assets/blog20210706_sast/sast-spotbugs.png" alt=""></td>
<td>Java. SpotBugs is the spiritual successor of FindBugs.</td>
</tr>
<tr>
<td>20.</td>
<td><a href="https://github.com/stelligent/cfn_nag">Stelligent cfn_nag</a></td>
<td><img src="/assets/blog20210706_sast/sast-stelligent-cfn_nag.png" alt=""></td>
<td>CloudFormation (.json, .yaml). Rules in Ruby</td>
</tr>
<tr>
<td>21.</td>
<td><a href="https://github.com/terraform-linters/tflint">Terraform Linter</a></td>
<td><img src="" alt=""></td>
<td>Terraform (.tf, .tfvars)</td>
</tr>
<tr>
<td>22.</td>
<td><a href="https://github.com/aquasecurity/tfsec">tfsec</a></td>
<td><img src="/assets/blog20210706_sast/sast-tfsec.png" alt=""></td>
<td>Terraform templates and support Terraform CDK.</td>
</tr>
<tr>
<td>-</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="the-cicd-tooling-and-the-pipeline-with-sast">The CI/CD Tooling and the Pipeline with SAST</h2>
<p>In order to embed the SAST process in our CI/CD pipeline, we will need at least 3 things:</p>
<ol>
<li>The CI/CD server</li>
</ol>
<ul>
<li>It will orchestrate the multiple tasks (stages) defined in our CI/CD workflow.</li>
<li>A CI/CD workflow or pipeline is a sequence of tasks or stages. In this post, I&rsquo;m going to use Jenkins with a pipeline with 4 stages: clone the GIT repository, run the SAST tools, get the report or outcomes and promote the code if the code is free of bugs.</li>
</ul>
<ol start="2">
<li>The SAST tool(s)</li>
</ol>
<ul>
<li>It will allow us to scan for vulnerabilities in our IaC (Terraform, Ansible, CloudFormation, Docker, Kubernetes, etc.) used in the project.</li>
<li>As above, there are many SAST tool, each one is for each type of code. That means we will need one or more SAST tool. Although I could use AWS Cfn-Lint or AquaSec Trivy, I choose KICKS because It integrates multiple IaC Linters in one.</li>
</ul>
<ol start="3">
<li>The CI/CD portal server</li>
</ol>
<ul>
<li>It will work as our web portal to consolidate all our outcomes in a single point.</li>
<li>Initially, I wanted to use SonarQube, but unfortunatelly it has limitations to <a href="https://docs.sonarqube.org/latest/analysis/external-issues/">import third party generated reports</a>, although It can be used as SAST tool as well, in this post I&rsquo;m going to use Jenkins and HTML reports.</li>
</ul>
<p><a href="/assets/blog20210706_sast/20210706-sast-in-your-cicd-pipeline.png"><img src="/assets/blog20210706_sast/20210706-sast-in-your-cicd-pipeline.png" alt=""></a>


<i><center>SAST stage in CI/CD Pipeline</center></i>

</p>
<h2 id="implementing-the-cicd-pipeline-with-a-sast-stage">Implementing the CI/CD Pipeline with a SAST stage</h2>
<ul>
<li>I&rsquo;m going to use AWS EC2 to deploy everything.</li>
<li>Everything will be Dockerized.</li>
<li>The Project I&rsquo;m going to use as example will be <a href="https://microservices-demo.github.io">Weaveworks Sock Shop</a>, specifically the version for AWS ECS which contains CloudFormation Templates.
In fact, you could use any kind of Cloud-Native Project, the only thing you need is the GitHub Repository URL. The Jenkins Pipeline I&rsquo;ve created uses by default <a href="https://github.com/bridgecrewio/terragoat.git">TerraGoat</a>.</li>
</ul>
<h3 id="steps">Steps</h3>
<p>I&rsquo;ve created a Github repository with a CDK Project that automate the creation of AWS EC2 instance, with bash scripts to automate the installation of Jenkins and default plugins and a <a href="https://github.com/chilcano/aws-cdk-examples/blob/main/simple-ec2/_scripts/sast-pipeline-kics.groovy">Jenkins Pipeline</a> that includes SAST stages in the CI/CD process.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git clone https://github.com/chilcano/aws-cdk-examples.git

cd aws-cdk-examples/simple-ec2/

npm install @aws-cdk/aws-ec2 @aws-cdk/aws-iam dotenv

cdk deploy --profile es --require-approval never --outputs-file output.json
</code></pre></div><p>Further details can be found in the <strong><a href="https://github.com/chilcano/aws-cdk-examples/tree/main/simple-ec2">Chilcano/AWS-CDK-Examples</a></strong> GitHub repository.</p>
<h2 id="conclusions">Conclusions</h2>
<ol>
<li>
<p>Since that a Cloud-Native App stack is composed of multiple building blocks, artifacts and different programming languages, you will need SAST Tools for each of them, although that is not a problem, the hard part will be consolidate all outcomes comming from multiple SAST Tools in a single point, and then to make the right decisions during CI/CD-runtime (Jenkins runtime). Said that, SonarQube CE covers this part while you don&rsquo;t have any approach in place yet, however importing third party reports into SonarQube is difficult.</p>
</li>
<li>
<p>Kics is a good SAST tool for Infrastructure as Code, It integrates multiple IaC Linters in one, but what if your project includes Golang code, Python code or Java code?. You will need to use other SAST Tools like GoSec, PyLint or Bandit, add a few stages to your Jenkins Pipeline and finally import all different reports generated for all SAST tools, even the Kics' report, in a single point, correlate and track all vulnerabilities using a common criteria, etc, being that a real headache. At this point, <a href="https://plugins.jenkins.io/warnings-ng/">Jenkins and Warnings-NG Plugin</a> help a lot. In a next post I will explain how to do that.</p>
</li>
</ol>
<h2 id="references">References</h2>
<ol>
<li><a href="https://awesomeopensource.com/projects/static-analysis">Awesome Open Source / The Top 254 Static Analysis Open Source Projects</a></li>
<li><a href="https://github.com/analysis-tools-dev/static-analysis">Analysis-Tools-Dev / Static-Analysis</a></li>
</ol>
  
  </div>
</article>


    <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2021  Holistic Security 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/post">Blog</a></li>
         
        <li><a href="/taxonomy">Taxonomy</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-156433649-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
</html>
